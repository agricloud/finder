{
    "type": "Ext.form.Panel",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "domainName": "none",
        "domainId": -1,
        "container|align": "stretch",
        "container|padding": null,
        "height": null,
        "maxHeight": 200,
        "minHeight": null,
        "width": null,
        "designer|userClassName": "CommonFileUploader",
        "designer|userAlias": "commonfileuploader",
        "layout": "vbox",
        "bodyPadding": 10,
        "title": null,
        "standardSubmit": null
    },
    "designerId": "b1003a58-0706-413b-9d42-3c00e1b0e7aa",
    "customConfigs": [
        {
            "group": "(Custom Properties)",
            "name": "domainName",
            "type": "string"
        },
        {
            "group": "(Custom Properties)",
            "name": "domainId",
            "type": "number"
        },
        {
            "group": "(Custom Properties)",
            "name": "testbtn",
            "type": "string"
        }
    ],
    "cn": [
        {
            "type": "Ext.toolbar.Toolbar",
            "reference": {
                "name": "dockedItems",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "layout|flex": 1,
                "dock": "top",
                "container|align": null,
                "container|pack": "center"
            },
            "designerId": "fdb3affe-69c6-4e4e-b886-0d9b602f78a0",
            "cn": [
                {
                    "type": "Ext.form.field.File",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": null,
                        "fieldLabel": null,
                        "name": "file",
                        "buttonOnly": true
                    },
                    "designerId": "1b4d3ac2-22a8-48aa-a4dd-7e4fb537ae8f"
                },
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": null,
                        "text": "開始上傳"
                    },
                    "designerId": "97b07d48-35f7-46c3-a36c-d794af4338c7",
                    "cn": [
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "handler",
                                "designer|params": [
                                    "button",
                                    "event"
                                ],
                                "implHandler": [
                                    "button.up('commonfileuploader').saveFile();"
                                ]
                            },
                            "designerId": "a4fc7b0c-782e-40fb-af67-6e2be9387c7b"
                        }
                    ]
                },
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": null,
                        "text": "刪除檔案"
                    },
                    "designerId": "100e953a-45a7-44e3-bc07-c6ad853e26ba",
                    "cn": [
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "handler",
                                "designer|params": [
                                    "button",
                                    "event"
                                ],
                                "implHandler": [
                                    "button.up('commonfileuploader').deleteFile();"
                                ]
                            },
                            "designerId": "1774787a-e5aa-44c2-a242-5c5c79bced59"
                        }
                    ]
                }
            ]
        },
        {
            "type": "Ext.form.field.Display",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "layout|flex": 1,
                "dock": null,
                "itemId": "mainDisplay",
                "fieldLabel": null,
                "value": [
                    "Display Field"
                ]
            },
            "designerId": "0e9fcf7b-905d-429a-b36a-121ca066aa99"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showFile",
                "implHandler": [
                    "",
                    "//console.log(\"do show file \"+'/attachment/show/'+this.domainId+\"?domainName=\"+this.domainName+'&fileType=file');",
                    "this.getComponent(\"mainDisplay\").setValue(",
                    "\t'<a href=\"/attachment/show/'+this.domainId+'?domainName='+this.domainName+'&fileType=file'+'\" target=\"_blank\" style=\"color:blue;text-decoration:underline;\">檢視檔案</a>');",
                    ""
                ]
            },
            "designerId": "b3aa277b-2213-4cfa-bb8e-367117724098"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "saveFile",
                "implHandler": [
                    "",
                    "var form = this.getForm();",
                    "var domainName = this.domainName;",
                    "var domainId = this.domainId;",
                    "",
                    "if(!domainId){",
                    "    Ext.Msg.alert('Error', \"can't get id!\");",
                    "",
                    "}else if(form.isValid()){",
                    "    var that=this;",
                    "    form.submit({",
                    "        url: '/attachment/save',",
                    "        waitMsg: 'Uploading your file...',",
                    "        params: {",
                    "            domainName:domainName,",
                    "            domainId: domainId,",
                    "            fileType: 'file'",
                    "        },",
                    "        success: function(form, action) {",
                    "            Ext.Msg.alert('Success', 'Your file has been uploaded.');",
                    "            that.showFile();",
                    "        }",
                    "    });",
                    "}"
                ]
            },
            "designerId": "c70acf4e-db49-43fd-bec8-49f2dbf04acf"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "deleteFile",
                "implHandler": [
                    "var that=this;",
                    "Ext.Ajax.request( {  ",
                    "    url : '/attachment/delete/'+this.domainId,",
                    "    method : 'post',  ",
                    "    params : {  ",
                    "        domainName : this.domainName,",
                    "    \tfileType: 'file'",
                    "    },  ",
                    "    success : function(response, options) {  ",
                    "        that.emptyFile();",
                    "    },  ",
                    "    failure : function() {  ",
                    "        Ext.Msg.alert('Error', \"can't delete image\");",
                    "    }  ",
                    "});",
                    "",
                    ""
                ]
            },
            "designerId": "315c26c1-989b-4bed-89cc-9bc862a13ff5"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "emptyFile",
                "implHandler": [
                    "this.getComponent(\"mainDisplay\").setValue('');"
                ]
            },
            "designerId": "bbf807c3-e88b-4c81-af35-e54737172615"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showToolbar",
                "implHandler": [
                    "this.down(\"toolbar\").setVisible(true); "
                ]
            },
            "designerId": "329359b0-8cf0-410a-a57d-e42a329733fe"
        },
        {
            "type": "processcfgfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "processCommonFileUploader",
                "designer|params": [
                    "config"
                ],
                "implHandler": [
                    "console.log(config.dockedItems);",
                    "",
                    "config.dockedItems[0].hidden=true;",
                    "",
                    "config.dockedItems[0].items[0].buttonText=Utilities.getMsg('common.fileBrowse.label');",
                    "config.dockedItems[0].items[1].text=Utilities.getMsg('common.uploadBtn.label');",
                    "config.dockedItems[0].items[2].text=Utilities.getMsg('common.deleteBtn.label');"
                ]
            },
            "designerId": "c936f631-6f9c-42a4-95c1-7aac036c5448"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "setDomainId",
                "designer|params": [
                    "id"
                ],
                "implHandler": [
                    "this.domainId=id;"
                ]
            },
            "designerId": "fba7786a-7ee0-4a61-9fc0-64ffd3ecafc8"
        }
    ]
}
{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "models": [
            "ErpMaterialReturnSheet",
            "ErpMaterialSheet",
            "ErpMaterialSheetDet",
            "Workstation",
            "Supplier",
            "Warehouse",
            "WarehouseLocation",
            "Batch",
            "ErpManufactureOrder",
            "ErpMaterialReturnSheetDet"
        ],
        "stores": [
            "ErpMaterialReturnSheetStore",
            "ErpMaterialSheetStore",
            "ErpMaterialSheetDetStore",
            "WorkstationStore",
            "SupplierStore",
            "WarehouseStore",
            "WarehouseLocationStore",
            "BatchStore",
            "ErpManufactureOrderStore",
            "ErpMaterialReturnSheetDetStore"
        ],
        "views": [
            "ErpMaterialReturnSheetView",
            "ErpMaterialSheetDetGrid",
            "ErpMaterialSheetGrid",
            "ErpMaterialReturnSheetGrid"
        ],
        "designer|userClassName": "ErpMaterialReturnSheetController",
        "mixins": [
            "{",
            "    commonController: 'foodprint.controller.CommonController'",
            "}"
        ]
    },
    "designerId": "5b2c688a-3183-428f-8d27-6bf6759681e9",
    "cn": [
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "mainGrid",
                "selector": "erpmaterialreturnsheetview #grid"
            },
            "designerId": "aaf3969e-1aeb-4aa9-b5b4-f03eb9a1abfa"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "mainForm",
                "selector": "erpmaterialreturnsheetview #form"
            },
            "designerId": "90116ba6-3df6-4f10-bcc7-4bb0418eecf7"
        },
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "init",
                "designer|params": [
                    "application"
                ],
                "implHandler": [
                    "this.control({",
                    "    'erpmaterialreturnsheetview #index commonindextoolbar commoncreatebtn':{",
                    "        click:this.doCreateAndIndexDetail",
                    "    },",
                    "    'erpmaterialreturnsheetview #index commonindextoolbar commonshowbtn':{",
                    "        click:this.doShowMaterialReturnSheet",
                    "    },",
                    "    'erpmaterialreturnsheetview #show commonshowtoolbar commondeletebtn':{",
                    "        click:this.doDelete",
                    "    },",
                    "    'erpmaterialreturnsheetview #show commonshowtoolbar commonsavebtn':{",
                    "        click:this.doSave",
                    "    },",
                    "    'erpmaterialreturnsheetview #show commonshowtoolbar commoncancelbtn':{",
                    "        click:this.doCancel",
                    "    },",
                    "    'erpmaterialreturnsheetview #grid':{",
                    "        select: this.enableShowBtn,",
                    "        deselect: this.disableShowBtn,",
                    "        itemdblclick: this.doShowMaterialReturnSheet",
                    "    },",
                    "    'erpmaterialreturnsheetview #show commonindextoolbar commoncreatebtn':{",
                    "        click:this.doCreateDetail",
                    "    },",
                    "    'erpmaterialreturnsheetview #show commonindextoolbar commonshowbtn':{",
                    "        click:this.doShowMaterialReturnSheetDet",
                    "    },",
                    "    'erpmaterialreturnsheetview #showDetail commonshowtoolbar commondeletebtn':{",
                    "        click:this.doDeleteDetail",
                    "    },",
                    "    'erpmaterialreturnsheetview #showDetail commonshowtoolbar commonsavebtn':{",
                    "        click:this.doSaveDetail",
                    "    },",
                    "    'erpmaterialreturnsheetview #showDetail commonshowtoolbar commoncancelbtn':{",
                    "        click:this.doCancelDetail",
                    "    },",
                    "    'erpmaterialreturnsheetview #show #indexDetail #detailGrid':{",
                    "        select: this.enableDetailShowBtn,",
                    "        deselect: this.disableDetailShowBtn,",
                    "        itemdblclick: this.doShowMaterialReturnSheetDet",
                    "    },",
                    "    'erpmaterialreturnsheetview #materialSheetDetIndex #detailGrid':{",
                    "        //itemdblclick: this.doSelectMaterialSheetDet //另解",
                    "        itemdblclick: this.doShowMaterialSheetDet",
                    "    },",
                    "    'erpmaterialreturnsheetview #showDetail #detailForm commonselectbtn':{",
                    "        click:this.activeMaterialSheetDetIndex",
                    "    },",
                    "    'erpmaterialreturnsheetview #showDetail #detailForm commoncancelbtn':{",
                    "        click:this.doCancelSelectMaterialSheetDet",
                    "    },",
                    "    'erpmaterialreturnsheetview #materialSheetDetIndex erpmaterialsheetgrid':{",
                    "        select: this.doIndexDetailMaterialSheet",
                    "    }",
                    "});",
                    "",
                    "",
                    "this.domainName = 'foodpaint';",
                    "this.foodpaintController = 'materialReturnSheet';",
                    "this.foodpaintDetController = 'materialReturnSheetDet';",
                    "this.masterKey='materialReturnSheet.id';"
                ]
            },
            "designerId": "23d09f47-d699-4a9e-b5fa-0b123f35655d"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "detailGrid",
                "selector": "erpmaterialreturnsheetview #show #indexDetail #detailGrid"
            },
            "designerId": "de10f169-abcf-4b01-b9d0-78b3645267ce"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "detailForm",
                "selector": "erpmaterialreturnsheetview #detailForm"
            },
            "designerId": "5f21d804-a0a0-4145-837a-24b530da47e5"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "materialSheetDetGrid",
                "selector": "erpmaterialreturnsheetview #materialSheetDetIndex #detailGrid"
            },
            "designerId": "1f8d1549-bffe-4221-acb2-605d0ccb1d89"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "doIndexDetailMaterialSheet",
                "designer|params": [
                    "obj, record, index, eOpts"
                ],
                "implHandler": [
                    "var grid = this.getMainGrid().up().up().down(\"panel[itemId=materialSheetDetIndex]\").down(\"grid[itemId=detailGrid]\");",
                    "console.log();",
                    "var store=grid.getStore(grid);",
                    "console.log(store);",
                    "",
                    "store.data.clear();",
                    "",
                    "var params = {};",
                    "params[\"materialSheet.id\"]=record.data.id;",
                    "",
                    "store.getProxy().extraParams = params;",
                    "store.load();"
                ]
            },
            "designerId": "56f9ff8e-1248-4319-87a2-0f3419870f4d"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "doCancelMaterialSheetDet",
                "implHandler": [
                    "",
                    "this.getDetailForm().getForm().setValues({",
                    "    'materialSheetDet.id':null,",
                    "    'materialSheetDet.typeName':null,",
                    "    'materialSheetDet.name':null,",
                    "    'materialSheetDet.sequence':null",
                    "});"
                ]
            },
            "designerId": "429e10ad-12cf-4543-bb80-43337e920776"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "doShowMaterialReturnSheet",
                "implHandler": [
                    "this.doShowAndIndexDetail(function(success,form,action){",
                    "",
                    "});"
                ]
            },
            "designerId": "ad549b24-164c-4d38-b380-d7b31f153f46"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "doShowMaterialReturnSheetDet",
                "implHandler": [
                    "",
                    "this.doShowDetail(function(success,form,action){",
                    "\t",
                    "});"
                ]
            },
            "designerId": "3d1db56e-4529-4420-837e-2635a4851673"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "doSelectMaterialSheetDet",
                "designer|params": [
                    "obj, record, index, eOpts"
                ],
                "implHandler": [
                    "this.getDetailForm().getForm().setValues({",
                    "",
                    "    'materialSheetDet.id':record.data['id'],",
                    "    'materialSheetDet.typeName':record.data['typeName'],",
                    "    'materialSheetDet.name':record.data['name'],",
                    "    'materialSheetDet.sequence':record.data['sequence'],",
                    "    'item.id':record.data['item.id'],",
                    "    'item.name':record.data['item.name'],",
                    "    'item.title':record.data['item.title'],",
                    "    'warehouse.id':record.data['warehouse.id'],",
                    "    'warehouse.name':record.data['warehouse.name'],",
                    "    'warehouse.title':record.data['warehouse.title'],",
                    "    'warehouseLocation.id':record.data['warehouseLocation.id'],",
                    "    'warehouseLocation.name':record.data['warehouseLocation.name'],",
                    "    'warehouseLocation.title':record.data['warehouseLocation.title'],",
                    "    'batch.id':record.data['batch.id'],",
                    "    'batch.name':record.data['batch.name'],",
                    "    'manufactureOrder.id':record.data['manufactureOrder.id'],",
                    "    'manufactureOrder.typeName':record.data['manufactureOrder.typeName'],",
                    "    'manufactureOrder.name':record.data['manufactureOrder.name']",
                    "});",
                    "",
                    "this.activeDetailEditor();",
                    "",
                    ""
                ]
            },
            "designerId": "82ee89ab-7fd0-4cb1-91f2-4d486cb75054"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "doShowMaterialSheetDet",
                "designer|params": [
                    "callback"
                ],
                "implHandler": [
                    "/*",
                    "this.doShowDetail(function(success,form,action){",
                    "});",
                    "*/",
                    "",
                    "console.log('commonController--'+this.domainName+'--doShowDetail');",
                    "",
                    "var that = this;",
                    "console.log(that);",
                    "",
                    "var record= this.getMaterialSheetDetGrid().getSelectionModel().getSelection()[0];",
                    "var id = -1;",
                    "",
                    "if(this.getMaterialSheetDetGrid().getSelectionModel().getSelection()[0])",
                    "id = record.data.id;",
                    "",
                    "",
                    "this.getDetailForm().getForm().load({",
                    "    url:this.getRoot()+'/'+this.domainName+'/show/'+id,",
                    "    params: this.getDetailParams(),",
                    "    waitMsg:Utilities.getMsg('default.message.load'),",
                    "    success: function(form, action) {",
                    "",
                    "        that.activeDetailEditor();",
                    "        that.detailActionName = 'update';",
                    "",
                    "        if (callback && callback instanceof Function) {",
                    "            callback(true,form,action);",
                    "        }",
                    "    },",
                    "",
                    "    failure: function(form, action) {",
                    "        Ext.MessageBox.alert('Failure',action.result.message);",
                    "        if (callback && callback instanceof Function){",
                    "            callback(false,form,action);",
                    "        }",
                    "    }",
                    "});",
                    "",
                    ""
                ]
            },
            "designerId": "6b94438d-235f-49bb-afc6-4f715e8df94b"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "doCancelSelectMaterialSheetDet",
                "implHandler": [
                    "var form=this.getDetailForm();",
                    "var id=form.down('field[name=id]').getValue();",
                    "var typeName=form.down('field[name=typeName]').getValue();",
                    "var name=form.down('field[name=name]').getValue();",
                    "var sequence=form.down('field[name=sequence]').getValue();",
                    "form.getForm().reset(true);",
                    "",
                    "form.getForm().setValues({",
                    "    'id':id,",
                    "    'typeName':typeName,",
                    "    'name':name,",
                    "    'sequence':sequence",
                    "});"
                ]
            },
            "designerId": "2499f2ef-f484-4091-8ccd-68d417ea226d"
        }
    ]
}
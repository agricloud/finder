{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "BatchExtendController"
    },
    "designerId": "257fd810-ecd2-4cd9-9efb-7fdf76914523",
    "cn": [
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "batchRouteDoCreate",
                "implHandler": [
                    "var viewer = this.getBatchViewer();",
                    "var grid = viewer.down('gridpanel[itemId=batchRouteGrid]');",
                    "var store = grid.getStore();",
                    "var form = viewer.down('form[itemId=batchForm]');",
                    "var id = form.down('numberfield[name=id]').getValue();",
                    "var data = {",
                    "    id:'',",
                    "    'batch.id':id,",
                    "    'workstation.id':'',",
                    "    'operation.id':'',",
                    "    sequence:store.getCount()+1",
                    "};",
                    "store.insert(store.getCount(),data);"
                ]
            },
            "designerId": "42ac1c6a-a54c-4af0-8ff1-691b4521ee81"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "batchRouteDoDelete",
                "implHandler": [
                    "var viewer = this.getBatchViewer();",
                    "var grid = viewer.down('gridpanel[itemId=batchRouteGrid]');",
                    "var sm = grid.getSelectionModel();",
                    "",
                    "editPlugin = grid.getPlugin('batchRouteEditPlugin');",
                    "editPlugin.cancelEdit();",
                    "",
                    "store=grid.getStore();",
                    "store.remove(sm.getSelection());"
                ]
            },
            "designerId": "9e41cdc2-1b7b-4686-833d-6384b55ec4ba"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "batchRouteDoSave",
                "implHandler": [
                    "var viewer = this.getBatchViewer();",
                    "var grid = viewer.down('gridpanel[itemId=batchRouteGrid]');",
                    "",
                    "var editPlugin=grid.getPlugin('batchRouteEditPlugin');",
                    "editPlugin.completeEdit();",
                    "",
                    "var form = viewer.down('form');",
                    "var id = form.down('numberfield[name=id]').getValue();",
                    "var store = grid.getStore();",
                    "store.sync({",
                    "    url: '/rest/batchRoute',",
                    "    waitMsg: 'Saving Data...',",
                    "    success: function() {",
                    "        console.log('Saving Success！');",
                    "        Ext.MessageBox.alert('Success','資料更新完成');",
                    "        store.data.clear();",
                    "        store.load({",
                    "            params:{'batch.id':id}",
                    "        });",
                    "    },",
                    "    failure: function() {",
                    "        console.log('Saving Failed！');",
                    "    }",
                    "});"
                ]
            },
            "designerId": "8afc8a78-3f31-4969-8523-90f68ef47bcb"
        }
    ]
}
{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "models": [
            "Batch",
            "BatchRotue"
        ],
        "stores": [
            "BatchStore",
            "BatchRouteStore",
            "BatchRouteParamsStore"
        ],
        "views": [
            "BatchParamsEditorCt",
            "BatchRouteParamsWindow"
        ],
        "designer|userClassName": "BatchParamsEditorController",
        "mixins": null
    },
    "designerId": "b45ae00c-f10f-4e06-afac-1db682d3ce23",
    "cn": [
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "batchParamsEditorCt",
                "selector": "batchparamseditorct"
            },
            "designerId": "7cbf55b4-dda1-49ae-a354-396c4e269377"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "batchParamsEditor",
                "selector": "batchparamseditor"
            },
            "designerId": "7afc0ef2-5b70-47ba-b132-f491b44d9bb5"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "batchRouteGrid",
                "selector": "batchroutegrid"
            },
            "designerId": "983d1235-9083-4028-9722-5dd9162dd43f"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "batchGrid",
                "selector": "batchgrid"
            },
            "designerId": "cf2c750e-4d15-4dbb-90f1-49e81227611f"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "batchForm",
                "selector": "form"
            },
            "designerId": "1286dca8-4881-4c0e-bc69-1eaf7fd61fcf"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "batchRouteParamsWindow",
                "selector": "batchrouteparamswindow"
            },
            "designerId": "a094a472-92c9-449a-a513-fcd7dc230e87"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "commonImageUploader",
                "selector": "commonimageuploader"
            },
            "designerId": "1196e7fa-62ec-4ca2-b622-e8fe981aeeee"
        },
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "init",
                "designer|params": [
                    "application"
                ],
                "implHandler": [
                    "this.control({",
                    "    'batchparamseditorct grid[itemId=batchGrid]':{",
                    "        itemdblclick:this.readBatch",
                    "    },",
                    "    'batchparamseditor grid[itemId=batchRouteGrid]':{",
                    "        itemdblclick:this.loadBatchRouteParams",
                    "    },",
                    "    'batchrouteparamswindow button[itemId=commonUpdateBtn]':{",
                    "        click:this.doUpdateBatchRouteParams",
                    "    }",
                    "});"
                ]
            },
            "designerId": "289ac197-fded-4411-8cea-f7e0e0141ccf"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "readBatch",
                "designer|params": [
                    "obj, record, item, index, e, eOpts"
                ],
                "implHandler": [
                    "console.log('batchParamsEditorCtrl.readBatch[dblClick]');",
                    "",
                    "this.getBatchForm().getForm().reset(true);",
                    "",
                    "this.getBatchParamsEditor().setActiveTab(this.getBatchParamsEditor().down('panel[itemId=batchViewer]').up());",
                    "this.getBatchParamsEditor().down('panel[itemId=batchForm]').doDisplay(record);",
                    "this.getBatchParamsEditor().down('tabpanel[itemId=batchParamsTp]').setActiveTab(this.getBatchRouteGrid().up());",
                    "",
                    "this.getBatchRouteGrid().loadBatchRoute(record.data.id);"
                ]
            },
            "designerId": "42e9cfbf-429e-4437-a431-844f01da3692"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "loadBatchRouteParams",
                "designer|params": [
                    "obj, record, item, index, e, eOpts"
                ],
                "implHandler": [
                    "console.log('batchParamsEditorCtrl.loadBatchRouteParams');",
                    "",
                    "var store=this.getStore('BatchRouteParamsStore');",
                    "store.data.clear();",
                    "var that=this;",
                    "this.getBatchRouteParamsWindow().show();",
                    "this.getBatchRouteParamsWindow().setLoading(lang['default.message.load'],true);",
                    "store.load({",
                    "    params:{'batch.id':record.data['batch.id'],",
                    "        'operation.id':record.data['operation.id']",
                    "    },",
                    "    callback:function(){",
                    "        //store.clearFilter();",
                    "        //store.filter('reportParams.operation.id',record.data['operation.id']);",
                    "",
                    "        var form=that.getBatchRouteParamsWindow().down('form[itemId=batchRouteParamsForm]');",
                    "",
                    "        form.down('fieldcontainer[itemId=dynamicContainer]').removeAll(); ",
                    "",
                    "        for(var i=0;i<store.getCount();i++){",
                    "",
                    "            var field=null;",
                    "",
                    "            switch(store.getAt(i).data['reportParams.param.paramType']){",
                    "                case \"INTEGER\":",
                    "                field={",
                    "                    xtype: 'numberfield'",
                    "                };",
                    "                break;",
                    "                case \"STRING\":",
                    "                field={",
                    "                    xtype: 'textfield'",
                    "                };",
                    "                break;",
                    "                case \"BOOLEAN\":",
                    "                field={",
                    "                    xtype: 'radiogroup',",
                    "                    items: [{",
                    "                        xtype: 'radiofield',",
                    "                        boxLabel: 'Y',",
                    "                        inputValue: true",
                    "                    },",
                    "                    {",
                    "                        xtype: 'radiofield',",
                    "                        boxLabel: 'N',",
                    "                        inputValue: false",
                    "                    }]",
                    "                };",
                    "                break;",
                    "                case \"LIST\":",
                    "                field={",
                    "                    xtype: 'textfield'",
                    "                    //    xtype: 'triggerfield'",
                    "                };",
                    "                break;",
                    "                default:",
                    "                console.log('error: not defined paramType');",
                    "                break;",
                    "",
                    "            }",
                    "",
                    "",
                    "            switch(store.getAt(i).data['reportParams.param.paramType']){",
                    "                case \"INTEGER\":",
                    "                case \"STRING\":",
                    "                case \"LIST\":",
                    "                field.name = store.getAt(i).data['id'];",
                    "",
                    "                if(store.getAt(i).data['value']==null || store.getAt(i).data['value']==''){",
                    "                    field.value = store.getAt(i).data['reportParams.param.defaultValue'];",
                    "                }",
                    "                else{",
                    "                    field.value = store.getAt(i).data['value'];",
                    "                }",
                    "                break;",
                    "",
                    "                case \"BOOLEAN\":",
                    "                field.items[0].name = store.getAt(i).data['id'];",
                    "                field.items[1].name = store.getAt(i).data['id'];",
                    "                field.vertical= true;",
                    "",
                    "                if(store.getAt(i).data['value']==null || store.getAt(i).data['value']==''){",
                    "",
                    "                    if(store.getAt(i).data['reportParams.param.defaultValue']=='true'){",
                    "                        field.items[0].checked = true;",
                    "                    }",
                    "                    else{",
                    "                        field.items[1].checked = true;",
                    "                    }",
                    "",
                    "                }",
                    "                else{",
                    "                    if(field.value=store.getAt(i).data['value']=='true'){",
                    "                        field.items[0].checked = true;",
                    "                    }",
                    "                    else{",
                    "                        field.items[1].checked = true;",
                    "                    }",
                    "                }",
                    "                break;",
                    "                //case \"LIST\":",
                    "                //break;",
                    "                default:",
                    "                break;",
                    "",
                    "            }//end switch",
                    "",
                    "            field.fieldLabel= store.getAt(i).data['reportParams.param.title'];",
                    "",
                    "            field.listeners={",
                    "                validitychange:{",
                    "                    fn:function(obj, isValid, eOpts){",
                    "                        if(isValid)",
                    "                        that.getBatchRouteParamsWindow().down('button[itemId=commonUpdateBtn]').setDisabled(false);",
                    "                        else",
                    "                        that.getBatchRouteParamsWindow().down('button[itemId=commonUpdateBtn]').setDisabled(true);",
                    "                    }",
                    "                }",
                    "            };",
                    "",
                    "            form.down('fieldcontainer[itemId=dynamicContainer]').add(field); ",
                    "        }//end for",
                    "",
                    "        that.getCommonImageUploader().setDomainId(record.data['id']);",
                    "",
                    "        that.getCommonImageUploader().showImage();",
                    "        that.getBatchRouteParamsWindow().setLoading(false);",
                    "",
                    "        //mask.hide();",
                    "    }//end callback",
                    "});//end load"
                ]
            },
            "designerId": "f597b3f8-c1ed-4ac6-b931-68c26157061e"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "doUpdateBatchRouteParams",
                "implHandler": [
                    "console.log('BatchParamsEditorCtrl.doUpdateBatchRouteParamsForm');",
                    "",
                    "var that=this;",
                    "",
                    "this.getBatchRouteParamsWindow().down('form[itemId=batchRouteParamsForm]').submit({",
                    "    url: '/batchReportDet/update',",
                    "    submitEmptyText: false,",
                    "    waitMsg: lang['default.message.update'],",
                    "    success: function(form,action) {",
                    "        Ext.MessageBox.alert('Success',action.result.message);",
                    "        that.getBatchRouteParamsWindow().close();",
                    "    },",
                    "    failure: function(form,action) {",
                    "        Ext.MessageBox.alert('Failure',action.result.message);",
                    "    }",
                    "});",
                    "this.getBatchRouteParamsWindow().down('button[itemId=commonUpdateBtn]').setDisabled(false);",
                    ""
                ]
            },
            "designerId": "681c6976-55d2-4a0e-8270-940ffb8cf60c"
        },
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onLaunch",
                "implHandler": [
                    "",
                    "Ext.widget('batchrouteparamswindow');",
                    "this.getCommonImageUploader().showToolbar();",
                    ""
                ]
            },
            "designerId": "d1e6b2ff-5b48-4d0e-9c74-50224b26d772"
        }
    ]
}